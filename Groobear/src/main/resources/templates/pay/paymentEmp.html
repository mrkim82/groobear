<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<br>
    <table style="width:200px; height:500px; display:inline-block">
    	<thead>
	    	<tr>
	    		<th><font size="3" color="gray">구성원</font></th>
	    	</tr>
    	</thead>
    	<tbody id="EmpBody">
    		<tr th:each="emp : ${payEmpList}" >
    			<td  onmousedown="empInfo(this);">
	    			[[${emp.name}]] | [[${emp.rank}]] | [[${emp.deptName}]]
	    			<div style="display:none">[[${emp.Id}]]</div>
	    			<div style="display:none">[[${emp.name}]]</div>
	    			<div style="display:none">[[${emp.rank}]]</div>
	    			<div style="display:none">[[${emp.deptName}]]</div>
    			</td>
    		</tr>
    	</tbody>
    	
    </table>
    <table style="display:inline-block">
    	<tbody>
    		<tr>
    			<td><button type="button" id="payUser" onclick="paySet()">결재자</button></td>
    		</tr>
    		<tr>
    			<td><button type="button" id="referrer" onclick="refSet()">참조자</button></td>
    		</tr>
    		<tr>
    			<td><button type="button" id="payDelete" onclick="userDel()">제외</button></td>
    		</tr>
    		<tr>
    			<td><button type="button" id="payCheck" onclick="userSet()">확인</button></td>
    		</tr>
    	</tbody>
    </table>
    <table style="width:200px; height:200px; display:inline-block;">
    	<thead>
    		<tr>
	    		<th><font size="3" color="gray">결재자</font></th>
	    	</tr>
    	</thead>
    	<tbody id="payUserList">
    		<tr><td>박대리 | 사원 | 메일팀</td></tr>
    		<tr><td>김영환 | 사원 | 메일팀</td></tr>
    		<tr><td>테스터 | 사원 | 메일팀</td></tr>
    	</tbody>
    </table>
    <table style="width:200px; height:200px;">
    	<thead>
    		<tr>
	    		<th><font size="3" color="gray">참조자</font></th>
	    	</tr>
    	</thead>
    	<tbody id="referrerList">
    		<tr><td>박대리 | 사원 | 메일팀</td></tr>
    		<tr><td>김영환 | 사원 | 메일팀</td></tr>
    		<tr><td>테스터 | 사원 | 메일팀</td></tr>
    	</tbody>
    </table>
    <input type="button" value="창닫기" onclick="window.close()">
    <script>
    	var empName = '';
    	var empRank = '';
    	var empDept = '';
    	var empId = '';
    	const payUserList = [];
    	const referrerList = [];
    	
    	function empInfo(e){
    		console.log(e.children[0].textContent);
    		empName = e.children[1].textContent;
			empRank = e.children[2].textContent;
			empDept = e.children[3].textContent;
			empId = e.children[0].textContent;
			console.log('empId = ',empName);
			console.log('empRank = ',empRank);
			console.log('empDept = ',empDept);
			console.log('empId = ',empId);
			
    	}
    	function paySet(){
    		//push pop 사용해야됨 이미 있는 유저정보는 추가할필요없음
    		console.log('paySet 클릭');
    		let trTag = document.createElement('tr');
    		let tdTag = document.createElement('td');
    		console.log('payUserList = ',payUserList);
       		let payuser = document.getElementById('payUserList');
       		let divTag = document.createElement('div');
       		divTag.style.display = 'none';
    		if(payUserList.length === 0){
    			console.log('값 없음');
    			console.log(payUserList);
        		tdTag.append(empName + ' | ');
        		tdTag.append(empRank+' | ');
        		tdTag.append(empDept);
        		divTag.append(empId);
        		trTag.append(divTag);
        		trTag.append(tdTag);
        		payuser.append(trTag);
        		payUserList.push(empId);
    		}else{
    			console.log('값 있음 조건비교')
    			for(var i=0; i<payUserList.length; i++){
        			if(payUserList[i] === empId){
        				console.log('이미 결재자 명단에 있는 유저입니다.');
        			}else{
        				console.log('조회중입니다.');
        				if(i === payUserList.length-1){
	        				console.log(payUserList);
	        	    		tdTag.append(empName + ' | '+empRank+' | '+empDept);
	                		divTag.append(empId);
	                		trTag.append(divTag);
	        	    		trTag.append(tdTag);
	        	    		payuser.append(trTag);
	        	    		payUserList.push(empId);
        				}
        			}
        		}
    		}
    		console.log(payUserList);
    	}
    	function refSet(){
    		//push pop 사용해야됨 이미 있는 유저정보는 추가할필요없음
    		console.log('refSet 클릭');
    		let trTag = document.createElement('tr');
    		let tdTag = document.createElement('td');
    		let referrer = document.getElementById('referrerList');
    		//여기에 숨겨둘 td태그 하나 만들어서 거기에 empId값 하나 추가. 해당 id로 referrerList값 제거할거임
    		if(referrerList.length === 0){
    			console.log('값 없음');
        		tdTag.append(empName + ' | '+empRank+' | '+empDept);
        		trTag.append(tdTag);
        		referrer.append(trTag);
        		referrerList.push(empId);
    		}else{
    			console.log('값 있음 조건비교')
    			for(var i=0; i<referrerList.length; i++){
        			if(referrerList[i] === empId){
        				console.log('이미 결재자 명단에 있는 유저입니다.');
        			}else{
        				console.log('조회중입니다.');
        				if(i === referrerList.length-1){
	        				console.log(referrerList);
	        	    		tdTag.append(empName + ' | '+empRank+' | '+empDept);
	        	    		trTag.append(tdTag);
	        	    		referrer.append(trTag);
	        	    		referrerList.push(empId);
        				}
        			}
        		}
    		}
    		console.log(referrerList);
    	}
    	function userDel(){
    		console.log('userDel 클릭');
    		
    	}
    	function userSet(){
    		console.log('userSet 클릭')
    	}
    </script>
</body>
</html>