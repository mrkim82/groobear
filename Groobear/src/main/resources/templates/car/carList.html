<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
 	  layout:decorate="~{layout/myPageATiles}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<div layout:fragment="content">
	<div>
		<div>
		<form name="searchForm" action="carList">
			<input type="hidden" name="page" value="1"/>
			<select name="type">
				<option value='' selected>선택</option>
				<option value='name' th:selected="${criteria.type == 'name'}">이름</option>
				<option value='deptName' th:selected="${criteria.type == 'deptName'}">부서</option>
				<option value='carNo' th:selected="${criteria.type == 'carNo'}">차량번호</option>
			</select>		
			<input type="text" name="keyword" th:value="${criteria.keyword}"/>
			<button type="submit" id="searchBtn">검색</button>
		</form>
	</div>
		<table>
			<thead>
				<tr>
					<th>사번</th>
					<th>부서</th>
					<th>이름</th>
					<th>차량번호</th>
					<th>연락처</th>
				</tr> 
			</thead>
			<tbody>
				<tr th:if="${carList != null}" th:each="car, stat:${carList}">
					<td>[[${car.empNo}]]</td>
					<td>[[${car.deptName}]]</td>
					<td>[[${car.name}]]</td>
					<td>[[${car.carNo}]]</td>
					<td>[[${car.phone}]]</td>
				</tr>
			</tbody>
		</table>
		
	</div>
	<div>
		<ul class="paging" th:if="${paging.endPage != 0}">
	        <li th:if="${paging.prev}">
	            <a th:href="|javascript:goPage([[${paging.startPage-1}]])|">이전</a>
	        </li>
	        <li th:each="num : ${#numbers.sequence(paging.startPage, paging.endPage)}">
	            <a th:href="|javascript:goPage([[${num}]])|" th:text="${num}"></a>
	        </li>
	        <li th:if="${paging.next and paging.endPage > 0}">
	            <a th:href="|javascript:goPage([[${paging.endPage+1}]])|">다음</a>
	        </li>
    	</ul>
	</div>
	
<script th:inline="javascript">
function goPage(p){
	searchForm.page.value = p;
	searchForm.submit();
}




/* 	const headers = ['empNo','deptName','name','carNo','phone'];

	document.querySelector('#searchBtn').addEventListener('click',searchCarInfo);
	document.querySelector('#keyword').addEventListener('keyup',function(e){
		if(e.keyCode == 13){
			searchCarInfo();
		}
	})
	
	function searchCarInfo(){
		let searchsel = document.getElementById('car_select').value;
		let keyword = document.getElementById('keyword').value;
		if(keyword != '' && searchsel != ''){
			document.getElementsByTagName('tbody')[2].replaceChildren();
			console.log(searchsel,keyword);
			let name = ""; 
			let carNo = "";
			let deptName = "";
			if(searchsel == 'name'){
				name = keyword;
				console.log('이름',keyword);
			}else if(searchsel == 'carNo'){
				carNo = keyword;
				console.log('차번호',keyword);
			}else if(searchsel == 'deptName'){
				deptName = keyword;
				console.log('부서명',keyword);
			}
			fetch('http://localhost:8081/searchPList',{
				method:"POST",
				headers : {
					'Content-Type': 'application/json'
				},
				body:JSON.stringify({
					"carNo" : carNo,
					"name" : name,
					"deptName" : deptName
				})
			}) 
			.then(response => response.json())
			.then(data => {
				data.forEach(car => {
					console.log(car);
					let trTg = document.createElement('tr');
					//trTg.addEventListener('click',함수명 )
					let tdTg = document.createElement('td');
					for(let header of headers){
						tdTg = document.createElement('td');
						tdTg.textContent = car[header];
						trTg.append(tdTg);
					}
					trTg.append(tdTg);
					let tbody = document.getElementsByTagName('tbody')[2];
					tbody.append(trTg);

				})
			})
			.catch(reject => console.log(reject));
		}else if(keyword != '' && searchsel == '') {
			alert('조건을 선택하세요 \n전체조회는 입력값을 비우고 검색해주세요.');
			location.reload();
		}else if(keyword == '' && searchsel != '') {
			alert('검색어를 입력 해 주세요. ');
			location.reload();
		}else{
			location.reload();
		}
	}
 */
  
</script>
</div>
</body>



</html>