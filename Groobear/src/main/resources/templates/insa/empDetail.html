<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Groobear 회원 상세조회</title>
	<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
	<style>
	 	@import url('https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Gugi&display=swap');
	    body {
	      font-family: 'Do Hyeon', serif;/*웹 폰트 지정*/
	      font-size : 17px;
	      }
	    input {
		    font-family: 'Do Hyeon', serif;/*웹 폰트 지정*/
		    background: #ffffff00;
		    font-size : 17px;
	    }
	    fieldset {
	    	background: #d5ece3;
    		border: 0px;
	    }
	    html {
	        background: #d3cdcd54;
	    }
	    .custom-button {
			color: #fff;
		}
		.custom-button:hover {
			color: black; /* 마우스 오버 시 글자색을 남색으로 변경 */
		  	cursor: pointer; /* 커서 모양을 손가락 모양으로 변경 */
		}
    </style>
</head>
<body>
	<form style="height: 400px;" action="/updateEmp" method="GET">
		<h2 style='text-align:center;'>Groobear 회원 상세조회</h2>
		<fieldset style="border-radius: 10px 10px 0px 0px;">
			<div class="row">
				<div class="col-4" style="display:inline-block;">
					<th:block th:if="${profImg != null && profImg != ''}">
						<img style="border-radius: 60px; width:120px;height:150px;" th:src="@{|/display?fileName=${#strings.replace(profImg.uploadPath,'\','/')}/s_${profImg.uuid}_${profImg.fileName}|}" 
													th:data-uploadpath="${profImg.uploadPath}" th:data-uuid="${profImg.uuid}"
													th:data-filename="${profImg.fileName}" data-type="true">
					</th:block>
					<th:block th:if="${profImg == null || profImg == ''}">
						<img style="border-radius: 60px; width:120px;height:150px;" src="../img/userProf.png">
					</th:block>								
				</div>
				<div class="col-6" style="display: inline-block;margin-left: 30px;position: absolute;">
					<a>사번 : </a><input name="empNo" style="width:120px; padding-top:10px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.empNo}" readonly><br>
					<a>이름 : </a><input name="name" style="width:120px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.name}" readonly><br>
					<a>직책 : </a><input name="rank" style="width:120px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.rank}" readonly><br>
					<a>부서 : </a><input name="deptName" style="width:120px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.deptName}" readonly><br>
					<a>재직여부 : </a><input name="empStatus" style="width:80px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.empStatus}" readonly>
				</div>
			</div>
		</fieldset>
		<fieldset style="margin-bottom:10px;border-radius: 0px 0px 10px 10px;">
			<a>연락처 : </a><input name="phone" style="width:200px; padding-top:10px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.phone}" readonly><br>
			<a>회사메일 : </a><input id="id" name="id" style="width:200px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.id}" readonly><br>
			<a>개인메일 : </a><input name="email" style="width:200px; padding-bottom:10px; border:0 solid black;" type="text" th:value="${empInfo.email}" readonly>
		</fieldset>
		<fieldset style="display: flex;background: #ffffff00;justify-content: center;border:hidden;">
			<button class="custom-button" th:if="${session.EmpGrade=='A'}" type="submit" style="border-radius: 10px;font-family: 'Do Hyeon', serif;margin-right:10px;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;width: 50px;height:35px;margin-right:10px;" id="updateBtn">수정</button>
			<button class="custom-button" th:if="${session.EmpGrade=='A'}" style="border-radius: 10px;font-family: 'Do Hyeon', serif;margin-right:10px;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;width: 50px;height:35px;margin-right:10px;" type="button" id="delBtn">삭제</button>
			<button class="custom-button" type="button" style="border-radius: 10px;font-family: 'Do Hyeon', serif;margin-right:10px;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;width: 50px;height:35px;" onclick="closeBtn()">닫기</button>
		</fieldset>
	</form>
	<script type="text/javascript">
	updateEmpInfo()
	//업데이트 시 동작 함수
	function updateEmpInfo() {
		window.opener.location.href="/empInfo";
	}
	$(document).ready(function() {
		$('#delBtn').on('click', function(){
			$.ajax({
	  			    url: "deleteEmp",
	  			    method: "POST",
	  			    contentType:"application/json; charset=utf-8",
	  			    data: JSON.stringify({
	  			      empNo: [[${empInfo.empNo}]],
	  			      id: $('#id').val()
	  			    }),
	  			    success: function(data) {
	  			    	if(data == "success"){
	  			    		window.opener.location.href="/empInfo";
	  			    		window.close();
	  			    	} else{
	  			    		alert('삭제 오류 발생');
	  			    	}	
	  			    },
	  			    error: function(err) {
							console.log(err);
	  			    }
	  			});
		})
	})
	//팝업 Close 기능
    function closeBtn() {
    	window.close();
    }; 
	</script>
</body>
</html>