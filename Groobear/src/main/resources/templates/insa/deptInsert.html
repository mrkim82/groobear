<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>그루베어(groobear) - 예담 NO.1 그룹웨어</title>
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Gugi&display=swap');
@import url('https://webfontworld.github.io/TheJamsil/TheJamsil.css');
    body {
      font-family: 'TheJamsil', serif;/*웹 폰트 지정*/
      font-size : 17px;
      background-color: #f7f7f7;
    }
	form {
		height: 200px;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		padding: 20px;
	}
	
	h2 {
		text-align: center;
		margin-bottom: 20px;
	}
	
	fieldset {
		border: 1px solid #ccc;
		padding: 10px;
		margin-bottom: 10px;
		width: 400px;
	}
	
	a {
		margin-left: 50px;
		font-weight: bold;
	}
	
	input[type="text"] {
		width: 120px;
		padding: 10px;
		border: 1px solid #ccc;
		border-radius: 5px;
		margin-bottom: 10px;
	}
	
	table {
		width: 100%;
		border-collapse: collapse;
		border: 1px solid #ccc; /* Add border around the table */
	}
	
	th, td {
		padding: 8px;
		text-align: left;
		border-bottom: 1px solid #ccc;
		font-size: 14px; /* Set font size for table cells */
	}
	
	.blueone th {
		background-color: #f0f8ff;
	}
	.custom-button {
		color: #fff;
	}
	.custom-button:hover {
		color: black; /* 마우스 오버 시 글자색을 남색으로 변경 */
	  	cursor: pointer; /* 커서 모양을 손가락 모양으로 변경 */
	}
	button:not(:last-child) {
		margin-right: 10px;
	}
	
	/* Add margin between "구성원" and the table */
	.members-table {
		margin-top: 30px;
	}
	/* Reduce vertical spacing between table rows */
	table tbody tr {
		line-height: 1; /* Adjust the value as per your preference */
	}
	html ::-webkit-scrollbar{
	 display: none;
	}
	/* The Modal (background) */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1050; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }
    
        /* Modal Content/Box */
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 30%; /* Could be more or less, depending on screen size */                          
        }
</style>
</head>
<body>
	<form style="height: 200px;">
		<h2 style="text-align:center; margin-top:50px;">Groobear 부서생성</h2>
		<fieldset style="border-radius: 10px;">
			<a>부서명 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: &nbsp;</a><input id="deptName" style="background: #ffffff00;width:120px; padding-bottom:10px; border:0 solid black;font-family: 'TheJamsil', serif;" type="text" value=""><br>
			<a>부서권한 &nbsp;: &nbsp;</a><select id="deptAuth" style="cursor:Pointer;width:120px;border: 1px solid lightgray;border-radius: 5px;height: 30px;text-align:center;font-family: 'TheJamsil', serif;">
								<option value="" selected>선택</option>
								<th:block th:each="auth, stance : ${deptAuth}">
									<option th:value="${auth.code}">[[${auth.codeName}]]</option>
								</th:block>
							 </select><br>
		</fieldset>
		
		<fieldset style="display: flex;justify-content: center;border:hidden;">
			<button type="button" class="custom-button" style="border-radius: 10px;font-family: 'TheJamsil', serif;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;width: 50px;height:35px;margin-right:10px;" id="addBtn">생성</button>
			<button type="button" class="custom-button" style="border-radius: 10px;font-family: 'TheJamsil', serif;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;width: 50px;height:35px;" onclick="closeBtn()">닫기</button>
		</fieldset>
	</form>
      <!-- The Modal -->
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content" style="box-shadow: 2px 4px 3px 3px darkgray;width: 500px;margin-top:280px;border-radius: 20px;padding:0px;">
      	<div class="modal-header" style="position: relative;border-bottom: 1px solid lightgray;padding: 2px;">
			<h5 class="modal-title" id="exampleModalLabel" style="font-size: 20px;margin-left: 15px;margin-top: 20px;margin-bottom: 20px;">부서권한조회</h5>
			<button type="button" class="btn-close" data-mdb-dismiss="modal" onclick="closeModal()"
				aria-label="Close" style="border-radius: 8px;border: 1px solid gray;padding: 2px 9px;background-color: #998b79;color: #fff;margin-right: 20px;margin-top: 15px;">X</button>
		</div>
                <p style="text-align: center; margin:20px;height: 70px;line-height: 70px;"><span style="font-size: 17pt;" id="spantext"></span></p>
            <div style="text-align: center;padding-bottom: 10px;padding-top: 10px;" onClick="close_pop();" id="goLogin">
	            <div class="modal-footer">
	                <span class="pop_bt"  style="cursor:pointer;border-radius: 10px;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;color: #fff;width: 70px;height: 45px;line-height: 45px;font-size: 17px;" id="closeModal">
	                     닫기
	                </span>
	            </div>
            </div>
      </div>
      </div>
    
	<script type="text/javascript">
	$(document).ready(function() {
		$('#addBtn').on('click', function(){
			let deptName = $('#deptName').val();
			let deptAuth = $('#deptAuth').val();
			if(deptName == ''){
				$('#spantext').text('부서명을 입력하세요.');
				$('#myModal').show();
	            $('#closeModal').on('click', function() {
	            	$('#myModal').hide();
	            })
			}else{
				$.ajax({
	      			url: "insertDept",
	      			method: "POST",
	      			contentType: "application/json; charset=utf-8",
	      			data:JSON.stringify({
	      				deptName: deptName,
	      				deptAuth: deptAuth
	      			}),
	      			success: function(data){
	      				console.log(data);
	      				if(data == 'success'){
	      					window.opener.location.href="/deptList";
	      					window.close();
	      				}else{
	      					$('#spantext').text('부서 생성 과정에서 오류 발생');
	      					$('#errorModal').show();
				            $('#closeModal').on('click', function() {
				            	$('#errorModal').hide();
				            })
	      				}
	      			},
	      			error : function(error){
	      				console.log(error);
	      			}
	      		});
			}
		})
	})
	//팝업 Close 기능
    function closeBtn() {
    	window.close();
    };
	</script>
</body>
</html>