<!DOCTYPE html>
<html
 xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
 layout:decorate="~{layout/boardTiles}">
 
<head>
	<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
	rel="stylesheet" />
<meta charset="UTF-8">
<style>

 /* The Modal (background) */ 
.modal {
	display: none;  
	position: fixed; 
	z-index: 1050;  
	left: 0;
	top: 0;
	width: 100%; 
	height: 100%; 
	overflow: auto;  
	background-color: rgb(0,0,0);  
	background-color: rgba(0,0,0,0.4); 
} 

.table {
	margin-top: 5px;
	text-align: center;
}
#ulId li.active a.page-link {
	background-color: #35A880;
	border: 1px solid #35A880;
	color:#fff
}
.searchBtn{
	border-radius: 10px;
	background-color: #399f61;
	border-color: #399f6100;
	box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;
	color: #fff;
	width: 50px;
	height:35px;
}

.resetBtn{
	border-radius: 10px;
	background-color: #399f61;
	border-color: #399f6100;
	box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;
	color: #fff;
}
.flex-container {
    
		position: absolute;
    top: 105%;
    left: 50%;
    transform: translate(-50%, -50%); 
}
.writeBtn{
	border-radius: 10px;
	background-color: #399f61;
	border-color: #399f6100;
	box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;
	color: #fff;
	width: 60px;
	height: 50px;
	float: right;
	margin: 10px;
}
.search-form {
    display: flex;
    align-items: center;
    gap: 10px; /* Gap between each form element */
}
h2{
	margin-top: 25px;
}
.tdWrite{
	width: 100px;
}
.tdDay{
	width: 100px;
}
.tdCount{
	width: 100px;
}
.tdWrite, .tdDay, .tdCount {
    padding-left: 0px !important; 
    padding-right: 0px !important;
}
.tdNo{
	width:100px;
}
.tdTitle{
	width:300px;
}
table.tdWrite { padding: 0; }
</style>
</head>

<body class="tjs">
	
<div layout:fragment="content" class="dohyeon" >
  <div>
    <h2 th:if="${boardVO.boardType == 'N'}">공지사항</h2>
    <h2 th:if="${boardVO.boardType == 'C'}">언론보도</h2>
    <h2 th:if="${boardVO.boardType == 'K'}">자유게시판</h2>
		<th:block th:if="${(boardVO.boardType == 'N') and ((session.EmpGrade == 'A') or (checkId.deptAuth == 'B1 ') or (checkId.deptAuth == 'B3 '))} ">
			<button style="
			position: absolute;
			right: 18px;
			top: 0px;
	" class="writeBtn" type="button" id="write" th:onclick="|location.href='@{/boardInsert(boardType=${boardVO.boardType})}'|">글쓰기</button>
		</th:block>
		<th:block th:if="${(boardVO.boardType == 'C') and ((session.EmpGrade == 'A') or (checkId.deptAuth == 'B2 ') or (checkId.deptAuth == 'B3 '))}">
			<button style="
			position: absolute;
			right: 18px;
			top: 0px;
	" class="writeBtn" type="button" id="write" th:onclick="|location.href='@{/boardInsert(boardType=${boardVO.boardType})}'|">글쓰기</button>
		</th:block>
		<th:block th:if="${boardVO.boardType == 'K'}">
			<button style="
			position: absolute;
			right: 18px;
			top: 0px;
	" class="writeBtn" type="button" id="write" th:onclick="|location.href='@{/boardInsert(boardType=${boardVO.boardType})}'|">글쓰기</button>
		</th:block>
	<table id="list" class="table table-hover">
		<thead>
			<tr>
				<td class="tdNo">글번호</td>
				<td class="tdTitle">제목</td>
				<td class="tdWrite">작성자</td>
				<td class="tdDay">작성일자</td>
				<td class="tdCount">조회수</td>
			</tr>
		</thead>
		<tbody id="bodyWash">
			<tr th:each="board, stat : ${boardList}" th:attr="onclick='window.location.href=\'/boardInfo?boardNo=' + ${board.boardNo} + '\''">
				<td th:text="${board.btNo}"></td>
				<td ><div style="text-align: left;  overflow:hidden;
					text-overflow:ellipsis;
					white-space:nowrap; width: 400px;">[[${board.title}]]</div></td>
				<td>[[${board.name}]]</td>
				<td th:text="${#dates.format(board.insertDate, 'yyyy.MM.dd')}"></td>
				<td>[[${board.count}]]</td>
				<td style="display:none;">[[${board.boardType}]]</td>
			</tr>
		</tbody>
	</table>
	<div>
	
    <ul id="ulId" class="paging pagination pagination-sm" style="display: flex;justify-content: center;" th:if="${paging.endPage != 0}">
			<li class="page-item">
				<a class="page-link" th:href="|javascript:goPage(1)|">&laquo;</a></li>
			<li class="page-item" th:if="${paging.prev}">
							<a class="page-link" th:href="|javascript:goPage([[${paging.startPage-1}]])|">&lsaquo;</a>
					</li>
			<li class="page-item active" th:class="${num==paging.cri.page ? 'active' : ''}" 
				th:each="num : ${#numbers.sequence(paging.startPage, paging.endPage)}">
				<a class="page-link" th:href="|javascript:goPage([[${num}]])|"
				th:text="${num}"></a>
			</li>
			<li class="page-item" th:if="${paging.next and paging.endPage > 0}">
							<a class="page-link" th:href="|javascript:goPage([[${paging.endPage+1}]])|">&rsaquo;</a>
					</li>
			<li class="page-item"><a class="page-link"
				th:href="|javascript:goPage([[${paging.totalCount / paging.cri.perPageNum + (paging.totalCount % paging.cri.perPageNum > 0 ? 1 : 0)}]])|">&raquo;</a>
			</li>
			</ul>

	</div>
	</div>
	<div class="flex-container">
		
		<form name="searchForm" action="boardList" class="search-form">
			<input type="hidden" name="boardType" th:value="${boardVO.boardType}"/>
			<input type="hidden" name="page" value="1"/>
			<select name="type" style="border: 1px solid gray;border-radius: 5px; height: 35px; width:90px;">
				<option value='' selected>-- 선택 --</option>
				<option value='title' th:selected="${criteria.type == 'title'}" >제목</option>
				<option value='content' th:selected="${criteria.type == 'content'}">내용</option>
				<option value='name' th:selected="${criteria.type == 'name'}">작성자</option>
			</select>
			<input type="text" name="keyword" th:value="${criteria.keyword}" style="border: 1px solid gray;border-radius: 5px;height: 35px; width:150px;"/>
			<button type="submit" id="searchBtn" class="searchBtn">검색</button>
		</form>
	</div>
<!-- <button type="button" id="resetBtn" class="resetBtn" style="visibility: hidden;">초기화</button> -->
<!-- <button type="button" th:onclick="|location.href='@{/boardList(boardType=${board.boardType})}'|" class="resetBtn" >초기화</button> -->
		<!-- The Modal -->
<!-- Modal -->
<div class="modal fade" id="errorModal" tabindex="-1"
role="dialog" aria-labelledby="deletePostModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document" style="width: 500px; ">
	<div class="modal-content" style="border: 1px solid #00000021;border-radius: 20px;box-shadow: 2px 4px 3px 3px darkgray;width: 500px; height:280px;">
		<div class="modal-header">
			<h5 class="modal-title" id="deletePostModalLabel">게시글 검색 알림</h5>
			<button type="button" class="close" data-dismiss="modal"
				aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		<div class="modal-body" style="display: flex; justify-content: space-evenly; font-size: 28px;color: black; text-align:center; height: auto;">
									<p style="font-size: 28px;color: black; margin:30px 0px; height: 40px !important;">검색 항목을 선택해주세요.</p>
							</div>
		<div class="modal-footer">
			<button id="firstCancel" type="button" class="btn btn-secondary"
				data-dismiss="modal" style="border-radius: 10px;background-color: #399f61;border-color: #399f6100;box-shadow: 0.5px 1.5px 1.5px 1.5px lightgray;color: #fff;width: 70px;height: 45px;font-size: 20px;">확인</button>
		</div>
	</div>
</div>
</div>
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
crossorigin="anonymous"></script>

<script th:inline="javascript">
	function closeErrorModal() {
			$('#errorModal').modal('hide');
	}

	$(document).ready(function() {
			// 검색 빈값 처리
			$('#searchBtn').on('click', function() {
					let val = $('select[name="type"]').val();
					if(val == '') {
							$('#pTextError').text('검색 항목을 선택해주세요.');
							$('#errorModal').modal('show'); // 모달 표시
							return false;
					}
			});
	});

		//초기화 처리
		$('#resetBtn').on('click', function() {
			$('input[name="keyword"]').val('');
		})

//페이징 관련
function goPage(p) {
    //event.preventDefault();
    document.searchForm.boardType.value = /*[[${boardVO.boardType}]]*/
    document.searchForm.page.value = p;
    document.searchForm.submit();
}
//날짜포맷 맞춰주는 함수 
//https://carrotweb.tistory.com/160 참고사이트.
function SimpleDateTimeFormat(date, pattern) {
	var dateString = pattern.replace(/(yyyy|MM|dd|HH|mm|ss|SSS)/g, function(match) {
		var matchString = "";
		switch(match) {
			case "yyyy":
				matchString = date.getFullYear();
				break;
			case "MM":
				matchString = date.getMonth() + 1;
				break;
			case "dd":
				matchString = date.getDate();
				break;
			case "HH":
				matchString = date.getHours();
				break;
			case "mm":
				matchString = date.getMinutes();
				break;
			case "ss":
				matchString = date.getSeconds();
				break;
			case "SSS":
				matchString = date.getMilliseconds();
				break;
			default :
				matchString = match;
				break;
		}
		if (match == "SSS") {
			if (matchString < 10) {
				matchString = "00" + matchString;
			} else if (matchString < 100) {
				matchString = "0" + matchString;
			}
		} else {
			if ((typeof(matchString) == "number" && matchString < 10)) {
				matchString = "0" + matchString;
			}
		}
		return matchString;
	});

	return dateString;
}

</script>
</div>
</body>
</html>